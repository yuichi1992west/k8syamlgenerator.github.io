<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Pod YAML Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <h2>Kubernetes Pod YAML Generator</h2>
    </header>

    <main class="main-container">
        <div class="input-panel" id="kube-form">
            <details open>
                <summary>基本情報</summary>
                <div class="content">
                    <div class="form-group"><label for="podName">Podの名前 <span class="required">(必須)</span><a href="https://k8s.io/docs/concepts/overview/working-with-objects/names/" target="_blank">Doc</a></label><input type="text" id="podName" value="my-pod" required></div>
                    <div class="form-group"><label for="namespace">場所 (ネームスペース) <a href="https://k8s.io/docs/concepts/overview/working-with-objects/namespaces/" target="_blank">Doc</a></label><input type="text" id="namespace" placeholder="default"></div>
                    <div class="form-group"><label>ラベル <a href="https://k8s.io/docs/concepts/overview/working-with-objects/labels/" target="_blank">Doc</a></label><div id="labels-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="labels">+ ラベルを追加</button></div>
                </div>
            </details>

            <details>
                <summary>Podの詳細設定</summary>
                <div class="content">
                     <div class="form-group"><label for="serviceAccountName">サービスアカウント名 <a href="https://k8s.io/docs/tasks/configure-pod-container/configure-service-account/" target="_blank">Doc</a></label><span class="notice">(注意: 事前にServiceAccountの作成が必要)</span><input type="text" id="serviceAccountName" placeholder="default"></div>
                    <div class="form-group"><label>ノードセレクター <a href="https://k8s.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank">Doc</a></label><div id="nodeSelector-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="nodeSelector">+ セレクターを追加</button></div>
                    <div class="form-group">
                        <label for="restartPolicy">再起動ポリシー <a href="https://k8s.io/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy" target="_blank">Doc</a></label>
                        <select id="restartPolicy">
                            <option value="Always">常に再起動 (Always)</option>
                            <option value="OnFailure">失敗時のみ再起動 (OnFailure)</option>
                            <option value="Never">再起動しない (Never)</option>
                        </select>
                    </div>
                </div>
            </details>
            
            <details>
                <summary>初期化コンテナ</summary>
                <div class="content">
                    <p class="description">メインコンテナが起動する前に、特定の準備処理を実行するためのコンテナです。</p>
                    <div id="initContainers-list" class="dynamic-list"></div>
                    <button type="button" class="button" data-action="add" data-type="initContainers">+ 初期化コンテナを追加</button>
                </div>
            </details>

            <details open>
                <summary>メインコンテナの設定</summary>
                <div class="content">
                    <div class="form-group"><label for="containerName">コンテナ名 <span class="required">(必須)</span></label><input type="text" id="containerName" value="main-container" required></div>
                    <div class="form-group"><label for="imageName">コンテナイメージ <span class="required">(必須)</span><a href="https://k8s.io/docs/concepts/containers/images/" target="_blank">Doc</a></label><input type="text" id="imageName" value="nginx:latest" required></div>
                    <div class="form-group"><label>起動コマンドと引数 <a href="https://k8s.io/docs/tasks/inject-data-application/define-command-argument-container/" target="_blank">Doc</a></label><div id="command-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="command">+ 起動コマンドを追加</button><div id="args-list" class="dynamic-list" style="margin-top:10px;"></div><button type="button" class="button" data-action="add" data-type="args">+ 引数を追加</button></div>
                </div>
            </details>

            <details><summary>環境変数</summary><div class="content"><h4>キーと値のペア</h4><div id="env-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="env">+ 環境変数を追加</button><hr><h4>ConfigMap/Secretから読み込み</h4><div id="envFrom-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="envFrom">+ 読み込み元を追加</button></div></details>
            
            <details><summary>ヘルスチェック（生存確認）</summary><div class="content" id="probe-container"></div></details>
            
            <details><summary>共有ストレージ（ボリューム）</summary><div class="content"><h4>共有ストレージの定義</h4><div id="volume-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="volume">+ 共有ストレージを追加</button><hr><h4>コンテナ内の接続先（マウント）</h4><div id="volumeMount-list" class="dynamic-list"></div><button type="button" class="button" data-action="add" data-type="volumeMount">+ 接続先を追加</button></div></details>
        </div>
        <div class="output-panel">
             <div class="output-panel-header">
                <div class="output-panel-buttons">
                    <button type="button" class="button" id="copy-yaml-btn">YAMLをコピー</button>
                    <button type="button" class="button secondary" id="save-yaml-btn">ファイルに保存</button>
                    <div class="comment-switch-container"><label for="comment-mode-toggle">コメント付きYAML</label><label class="switch"><input type="checkbox" id="comment-mode-toggle"><span class="slider round"></span></label></div>
                </div>
                 <div id="deploy-command" class="command"></div>
            </div>
            <textarea id="yaml-output" readonly></textarea>
        </div>
    </main>

    <template id="key-value-template"><div class="dynamic-list-item key-value-item"><div><label>キー (名前)</label><input type="text" class="item-key" placeholder="例: app"></div><div><label>値</label><input type="text" class="item-value" placeholder="例: my-nginx"></div><button type="button" class="button danger" data-action="remove">X</button></div></template>
    <template id="single-value-template"><div class="dynamic-list-item single-value-item"><div><label>値</label><input type="text" class="item-value" placeholder="例: /bin/sh"></div><button type="button" class="button danger" data-action="remove">X</button></div></template>
    <template id="volume-template"><div class="dynamic-list-item"><div><div class="form-group"><label>共有ストレージ名 <span class="required">(必須)</span></label><input type="text" class="item-name" required></div><div class="form-group"><label>種類</label><select class="item-type"><option value="emptyDir">一時</option><option value="configMap">ConfigMap</option><option value="secret">Secret</option><option value="persistentVolumeClaim">永続ボリューム(PVC)</option></select></div><div class="volume-options"></div></div><button type="button" class="button danger" data-action="remove">削除</button></div></template>
    <template id="volumeMount-template"><div class="dynamic-list-item key-value-item"><div><label>接続するストレージ</label><select class="item-name"></select></div><div><label>コンテナ内のパス <span class="required">(必須)</span></label><input type="text" class="item-mountPath" placeholder="/path/in/container" required></div><button type="button" class="button danger" data-action="remove">X</button></div></template>
    <template id="probe-template"><div class="dynamic-list-item probe-item"><h4 class="probe-label"></h4><div class="form-group"><label>確認方法</label><select class="probe-type"><option value="none">設定しない</option><option value="httpGet">HTTPリクエスト</option><option value="tcpSocket">TCP接続</option><option value="exec">コマンド実行</option></select></div><div class="probe-options"></div><div class="sub-form-group" style="margin-top:10px;"><input type="number" class="probe-initialDelaySeconds" placeholder="初回確認までの時間(秒)"><input type="number" class="probe-periodSeconds" placeholder="確認間隔(秒)"><input type="number" class="probe-timeoutSeconds" placeholder="タイムアウト(秒)"><input type="number" class="probe-failureThreshold" placeholder="失敗とみなす回数"></div></div></template>
    <template id="initContainer-template"><div class="dynamic-list-item"><h4>初期化コンテナ</h4><div class="form-group"><label>コンテナ名 <span class="required">(必須)</span></label><input type="text" class="item-name" required></div><div class="form-group"><label>コンテナイメージ <span class="required">(必須)</span></label><input type="text" class="item-image" required></div><button type="button" class="button danger" data-action="remove">削除</button></div></template>
    <template id="envFrom-template"><div class="dynamic-list-item envFrom-item"><div><label>ソースの種類</label><select class="item-type"><option value="configMapRef">ConfigMap</option><option value="secretRef">Secret</option></select></div><div><label>ソースの名前</label><input type="text" class="item-name" placeholder="Name of source"></div><button type="button" class="button danger" data-action="remove">X</button></div></template>
    
    <script src="script.js" defer></script>
</body>
</html>